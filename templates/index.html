<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apple Developer Screenshot Resizer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'accent-blue': '#2563eb',
                        'accent-green': '#059669',
                    }
                }
            }
        }
    </script>
    <style>
        .drop-zone {
            transition: all 0.3s ease;
        }
        
        .drop-zone.dragover {
            border-color: #2563eb;
            background-color: #eff6ff;
            transform: scale(1.02);
        }
        
        .htmx-indicator {
            opacity: 0;
            transition: opacity 200ms ease-in;
        }
        
        .htmx-request .htmx-indicator {
            opacity: 1;
        }
        
        .htmx-request.htmx-indicator {
            opacity: 1;
        }
        
        .button-hover {
            transition: all 0.2s ease;
        }
        
        .button-hover:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .step-item {
            transition: all 0.2s ease;
        }
        
        .step-item:hover {
            transform: translateX(4px);
        }
    </style>
</head>
<body class="bg-white text-gray-900 font-sans antialiased">
    <div class="min-h-screen max-w-4xl mx-auto px-6 py-12">
        <!-- Header -->
        <div class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold mb-4">Apple Developer Screenshot Resizer</h1>
            <p class="text-lg text-gray-600 mb-8">Automatically resize screenshots for Apple App Store Connect submission</p>
            <p class="text-gray-700 max-w-2xl mx-auto">Avoid App Store rejections due to incorrect screenshot dimensions. Upload your mobile screenshots and get them resized to Apple's exact specifications for the App Store Connect developer portal.</p>
        </div>

        <!-- Upload Section -->
        <div x-data="fileUpload()" class="mb-12">
            <h2 class="text-2xl font-semibold mb-6 pb-2 border-b-2 border-gray-900">Upload Screenshot</h2>
            
            <form id="upload-form" 
                  hx-post="/upload" 
                  hx-encoding="multipart/form-data"
                  hx-target="#results"
                  hx-indicator="#processing"
                  enctype="multipart/form-data">
                
                <div class="drop-zone border-2 border-dashed border-gray-300 rounded-xl p-12 text-center cursor-pointer bg-gray-50 hover:border-gray-400 hover:bg-gray-100"
                     :class="{ 'dragover': isDragging }"
                     @drop.prevent="handleDrop($event)"
                     @dragover.prevent="isDragging = true"
                     @dragenter.prevent="isDragging = true"
                     @dragleave.prevent="isDragging = false"
                     @click="$refs.fileInput.click()">
                    
                    <div x-show="!selectedFile">
                        <div class="text-6xl mb-4">ðŸ“±</div>
                        <p class="text-xl mb-2">Drag and drop your screenshot here</p>
                        <p class="text-gray-600 mb-4">or click to select a file</p>
                        <p class="text-sm text-gray-500">Supports JPG and PNG files (max 16MB)</p>
                    </div>
                    
                    <div x-show="selectedFile" class="bg-white rounded-lg p-6 inline-block">
                        <div class="text-4xl text-accent-green mb-4">âœ“</div>
                        <div class="font-semibold text-lg mb-2" x-text="selectedFile?.name"></div>
                        <div class="text-gray-600 text-sm" x-text="formatFileSize(selectedFile?.size)"></div>
                    </div>
                </div>
                        
                <input type="file" 
                       name="file" 
                       x-ref="fileInput"
                       @change="handleFileSelect($event)"
                       accept=".png,.jpg,.jpeg"
                       class="hidden">
                
                <div class="text-center mt-8">
                    <button type="submit" 
                            :disabled="!selectedFile"
                            class="bg-gray-900 text-white px-8 py-3 rounded-lg font-semibold button-hover disabled:bg-gray-400 disabled:cursor-not-allowed mr-4">
                        Process Screenshot
                    </button>
                    
                    <button type="button" 
                            @click="clearFile()"
                            x-show="selectedFile"
                            class="bg-white text-gray-900 border border-gray-900 px-8 py-3 rounded-lg font-semibold button-hover">
                        Clear
                    </button>
                </div>
            </form>
        </div>

        <!-- Processing Indicator -->
        <div id="processing" class="htmx-indicator mb-12">
            <div class="text-center p-8 bg-gray-50 rounded-xl">
                <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-accent-blue mb-4"></div>
                <p class="text-gray-700">Processing your screenshot...</p>
            </div>
        </div>

        <!-- Results Area -->
        <div id="results" class="mb-12">
            <!-- Results will be populated here by HTMX -->
        </div>

        <!-- Instructions -->
        <div class="bg-gray-50 rounded-xl p-8 border-l-4 border-accent-blue">
            <h3 class="text-xl font-semibold mb-6">How it works</h3>
            <div class="space-y-4">
                <div class="step-item flex items-start">
                    <span class="text-accent-blue font-bold mr-4">â†’</span>
                    <span>Upload your mobile screenshot (JPG or PNG format)</span>
                </div>
                <div class="step-item flex items-start">
                    <span class="text-accent-blue font-bold mr-4">â†’</span>
                    <span>Tool analyzes dimensions and finds closest Apple App Store specification</span>
                </div>
                <div class="step-item flex items-start">
                    <span class="text-accent-blue font-bold mr-4">â†’</span>
                    <span>Image is resized to exact pixel requirements using center-crop</span>
                </div>
                <div class="step-item flex items-start">
                    <span class="text-accent-blue font-bold mr-4">â†’</span>
                    <span>Download properly sized screenshot for App Store Connect submission</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        function fileUpload() {
            return {
                selectedFile: null,
                isDragging: false,
                
                handleFileSelect(event) {
                    const file = event.target.files[0];
                    if (file && this.validateFile(file)) {
                        this.selectedFile = file;
                    }
                },
                
                handleDrop(event) {
                    this.isDragging = false;
                    const file = event.dataTransfer.files[0];
                    if (file && this.validateFile(file)) {
                        this.selectedFile = file;
                        // Update the file input
                        const fileInput = this.$refs.fileInput;
                        const dataTransfer = new DataTransfer();
                        dataTransfer.items.add(file);
                        fileInput.files = dataTransfer.files;
                    }
                },
                
                validateFile(file) {
                    const allowedTypes = ['image/png', 'image/jpeg', 'image/jpg'];
                    const maxSize = 16 * 1024 * 1024; // 16MB
                    
                    if (!allowedTypes.includes(file.type)) {
                        alert('Please upload a PNG or JPG file.');
                        return false;
                    }
                    
                    if (file.size > maxSize) {
                        alert('File size must be less than 16MB.');
                        return false;
                    }
                    
                    return true;
                },
                
                formatFileSize(bytes) {
                    if (!bytes) return '';
                    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                    const i = Math.floor(Math.log(bytes) / Math.log(1024));
                    return Math.round(bytes / Math.pow(1024, i) * 100) / 100 + ' ' + sizes[i];
                },
                
                clearFile() {
                    this.selectedFile = null;
                    this.$refs.fileInput.value = '';
                    document.getElementById('results').innerHTML = '';
                }
            }
        }
    </script>
</body>
</html>